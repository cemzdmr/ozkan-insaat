// √ñzkan ƒ∞n≈üaat Database Schema
// Enterprise-grade schema for construction corporate website

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ==================== USER MANAGEMENT ====================

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String
  role      UserRole @default(EDITOR)
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}

enum UserRole {
  ADMIN
  EDITOR
}

// ==================== PAGES & SECTIONS ====================

model Page {
  id          String    @id @default(cuid())
  slug        String    @unique
  type        PageType
  published   Boolean   @default(false)
  order       Int       @default(0)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  
  content     PageContent[]
  sections    PageSection[]
  seo         PageSEO[]

  @@map("pages")
}

enum PageType {
  HOME
  ABOUT
  PROJECTS
  REFERENCES
  CONTACT
  CUSTOM
}

model PageContent {
  id          String   @id @default(cuid())
  pageId      String
  language    Language
  title       String
  description String?  @db.Text
  
  page        Page     @relation(fields: [pageId], references: [id], onDelete: Cascade)
  
  @@unique([pageId, language])
  @@map("page_content")
}

model PageSection {
  id          String   @id @default(cuid())
  pageId      String
  type        SectionType
  order       Int
  visible     Boolean  @default(true)
  settings    Json     // Layout, background, animations, etc.
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  page        Page     @relation(fields: [pageId], references: [id], onDelete: Cascade)
  content     SectionContent[]
  
  @@map("page_sections")
}

enum SectionType {
  HERO
  TEXT_IMAGE
  SERVICES
  PROJECTS_GRID
  STATISTICS
  LOGO_CAROUSEL
  CTA
  CUSTOM_HTML
  VIDEO
  GALLERY
  TEAM
  TIMELINE
}

model SectionContent {
  id          String      @id @default(cuid())
  sectionId   String
  language    Language
  data        Json        // All language-specific content
  
  section     PageSection @relation(fields: [sectionId], references: [id], onDelete: Cascade)
  
  @@unique([sectionId, language])
  @@map("section_content")
}

model PageSEO {
  id          String   @id @default(cuid())
  pageId      String
  language    Language
  metaTitle   String
  metaDescription String @db.Text
  keywords    String?
  ogImage     String?
  
  page        Page     @relation(fields: [pageId], references: [id], onDelete: Cascade)
  
  @@unique([pageId, language])
  @@map("page_seo")
}

// ==================== PROJECTS ====================

model Project {
  id          String    @id @default(cuid())
  slug        String    @unique
  featured    Boolean   @default(false)
  published   Boolean   @default(false)
  status      ProjectStatus @default(COMPLETED)
  year        Int?
  location    String?
  coverImage  String?
  order       Int       @default(0)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  
  content     ProjectContent[]
  categories  ProjectCategory[]
  gallery     ProjectGallery[]
  highlights  ProjectHighlight[]

  @@map("projects")
}

enum ProjectStatus {
  ONGOING
  COMPLETED
  PLANNED
}

model ProjectContent {
  id          String   @id @default(cuid())
  projectId   String
  language    Language
  title       String
  description String   @db.Text
  details     String?  @db.Text
  
  project     Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
  
  @@unique([projectId, language])
  @@map("project_content")
}

model Category {
  id          String   @id @default(cuid())
  slug        String   @unique
  order       Int      @default(0)
  
  names       CategoryName[]
  projects    ProjectCategory[]

  @@map("categories")
}

model CategoryName {
  id          String   @id @default(cuid())
  categoryId  String
  language    Language
  name        String
  
  category    Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  
  @@unique([categoryId, language])
  @@map("category_names")
}

model ProjectCategory {
  projectId   String
  categoryId  String
  
  project     Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
  category    Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  
  @@id([projectId, categoryId])
  @@map("project_categories")
}

model ProjectGallery {
  id          String   @id @default(cuid())
  projectId   String
  type        MediaType
  url         String
  thumbnail   String?
  order       Int      @default(0)
  
  project     Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
  
  @@map("project_gallery")
}

enum MediaType {
  IMAGE
  VIDEO
}

model ProjectHighlight {
  id          String   @id @default(cuid())
  projectId   String
  language    Language
  text        String
  order       Int      @default(0)
  
  project     Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
  
  @@map("project_highlights")
}

// ==================== REFERENCES ====================

model Reference {
  id          String    @id @default(cuid())
  slug        String    @unique
  logo        String
  order       Int       @default(0)
  published   Boolean   @default(true)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  
  content     ReferenceContent[]
  
  @@map("references")
}

model ReferenceContent {
  id          String    @id @default(cuid())
  referenceId String
  language    Language
  name        String
  testimonial String?   @db.Text
  author      String?
  position    String?
  
  reference   Reference @relation(fields: [referenceId], references: [id], onDelete: Cascade)
  
  @@unique([referenceId, language])
  @@map("reference_content")
}

// ==================== SERVICES ====================

model Service {
  id          String    @id @default(cuid())
  icon        String    @default("üèóÔ∏è")
  order       Int       @default(0)
  active      Boolean   @default(true)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  
  content     ServiceContent[]
  features    ServiceFeature[]
  
  @@map("services")
}

model ServiceContent {
  id          String   @id @default(cuid())
  serviceId   String
  language    Language
  title       String
  description String   @db.Text
  
  service     Service  @relation(fields: [serviceId], references: [id], onDelete: Cascade)
  
  @@unique([serviceId, language])
  @@map("service_content")
}

model ServiceFeature {
  id          String   @id @default(cuid())
  serviceId   String
  language    Language
  text        String
  order       Int      @default(0)
  
  service     Service  @relation(fields: [serviceId], references: [id], onDelete: Cascade)
  
  @@map("service_features")
}

// ==================== CONTACT ====================

model ContactInfo {
  id          String   @id @default(cuid())
  language    Language @unique
  address     String   @db.Text
  phone       String
  email       String
  mapUrl      String?
  whatsapp    String?
  workingHours String?
  updatedAt   DateTime @updatedAt
  
  @@map("contact_info")
}

model ContactSubmission {
  id          String   @id @default(cuid())
  name        String
  email       String
  phone       String?
  subject     String?
  message     String   @db.Text
  read        Boolean  @default(false)
  archived    Boolean  @default(false)
  createdAt   DateTime @default(now())
  
  @@map("contact_submissions")
}

// ==================== MEDIA ====================

model Media {
  id          String    @id @default(cuid())
  filename    String
  originalName String
  mimeType    String
  size        Int
  url         String
  thumbnail   String?
  alt         String?
  createdAt   DateTime  @default(now())
  
  @@map("media")
}

// ==================== SETTINGS ====================

model SiteSetting {
  id          String   @id @default(cuid())
  key         String   @unique
  value       Json
  updatedAt   DateTime @updatedAt
  
  @@map("site_settings")
}

// ==================== ENUMS ====================

enum Language {
  TR
  EN
  AR
}
